events {}

http {
    upstream quartos-service {
        server quartos-service:3000;
    }

    upstream reservas-service {
        server reservas-service:3000;
    }

    upstream usuarios-service {
        server usuarios-service:3000;
    }

    server {
        listen 80;

        # --- SEÇÃO PARA SERVIR O FRONTEND (ADICIONADA/CORRIGIDA) ---
        root /usr/share/nginx/html; # Onde o Nginx encontrará os arquivos do frontend
        index index.html;           # O arquivo principal do seu frontend

        location / {
            # Tenta encontrar o arquivo, se não achar, redireciona para index.html (essencial para SPAs)
            try_files $uri $uri/ /index.html;
        }
        # -------------------------------------------------------------

        # --- SEÇÕES DE PROXY REVERSO PARA OS BACKENDS ---
        location /quartos-service/ {
            proxy_pass http://quartos-service/;
        }

        location /reservas-service/ {
            proxy_pass http://reservas-service/;
        }

        location /usuarios-service/ {
            proxy_pass http://usuarios-service/;
        }
        # -------------------------------------------------
    }
}